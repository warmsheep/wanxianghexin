# 系统部署与运维

---

### 网络部署结构

> 网络部署结构将整个网络分成：DMZ入口、DMZ外联、DMZ互联、AP区、运维管理区，同时将DMZ入口会划分成DMZ核心入口以及普通入口区，AP区划分为AP核心区、AP普通区、AP中间件区、AP数据库区。大的区域之间网络互不打通，需要开通网络策略才可进行访问。

* DMZ入口：接收外部请求，主要部署网关、API应用、代理服务（Nginx/APISIX）
* DMZ外联：发送请求至互联网（部署Gateway应用、代理服务Nginx）
* DMZ互联：和银行、机构的专线连接（部署Gateway应用、渠道应用）
* AP：业务应用、中间件、数据库
* 运维管理区：堡垒机、自动化运维工具、VPN

![](/assets/网络结构示意图.png)

### 混合云部署

> 通过在托管机房和云服务提供商分别建一整套完整应用，银行前置机和UKEY设备托管放置在机房，通过专线互联。从网络质量区分多线路，应用灾备多地。

![](/assets/混合云部署方案.png)

### 数据库部署

> 数据库采用一主两从一历史库策略，分别做主从高可用切换，读写分离，历史归档用途。

* 高可用：保障数据库主库故障能够迅速切换至从库，达成SLA等级
* 读写分离：将大量查询请求发往第二从库，降低主库的日常负载，提升整体数据库处理能力。
* 历史归档：将半年以上的历史数据迁移至历史库，通过FDW链接。维持主库大小相对恒定，数据库性能不会随着时间线性下降。
* 延迟备库：资源充足情况下考虑做延迟备库，主要应对误操作、误删除、误更新，延迟备库保留有一定时间内未操作数据供恢复，降低数据风险。



